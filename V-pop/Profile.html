<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link rel="stylesheet" href="css/Profile.css">
    <link rel="icon" type="image/x-icon" href="assets/wildcat.ico" />
</head>
<body>
    <div class="profile-container">
        <h2>Welcome to Your Profile</h2>
        <div id="profile-data"></div>

        <!-- Edit button -->
        <div class="button-container">
            <button id="editButton">Edit Profile</button>
        </div>

        <!-- Button to go back to index.html -->
        <div class="button-container">
            <button onclick="window.location.href='index.html'">Back to Home</button>
        </div>
    </div>

    <script type="module">
        // Retrieve profile data from sessionStorage
        const profileData = JSON.parse(sessionStorage.getItem("userProfile"));

        // Function to display profile data as form fields
        function displayProfileData() {
            const profileDiv = document.getElementById('profile-data');
            profileDiv.innerHTML = `
                <form id="profileForm">
                    <label for="firstName">First Name:</label>
                    <input type="text" id="firstName" value="${profileData.firstName}"><br><br>

                    <label for="lastName">Last Name:</label>
                    <input type="text" id="lastName" value="${profileData.lastName}"><br><br>

                    <label for="email">Email:</label>
                    <input type="email" id="email" value="${profileData.email}"><br><br>

                    <label for="age">Age:</label>
                    <input type="number" id="age" value="${profileData.age}"><br><br>

                    <label for="gender">Gender:</label>
                    <input type="text" id="gender" value="${profileData.gender}"><br><br>

                    <label for="major">Major:</label>
                    <input type="text" id="major" value="${profileData.major}"><br><br>

                    <label for="minors">Minors:</label>
                    <input type="text" id="minors" value="${profileData.minors || ''}"><br><br>

                    <button type="button" id="saveButton">Save Changes</button>
                </form>
            `;
        }

        // If profile data exists, display it
        if (profileData) {
            displayProfileData();
        } else {
            // If profile data doesn't exist, show an error message and redirect to login
            alert("Profile data not found. Please log in first.");
            window.location.href = 'Login.html'; // Redirect to login if data is not found
        }

        // Handle the "Save Changes" button click
        document.getElementById("saveButton").addEventListener("click", function() {
            const updatedProfileData = {
                firstName: document.getElementById("firstName").value,
                lastName: document.getElementById("lastName").value,
                email: document.getElementById("email").value,
                age: document.getElementById("age").value,
                gender: document.getElementById("gender").value,
                major: document.getElementById("major").value,
                minors: document.getElementById("minors").value || null,
            };

            // Save the updated profile data back to sessionStorage
            sessionStorage.setItem("userProfile", JSON.stringify(updatedProfileData));

            // Refresh the profile display with the updated data
            displayProfileData();

            // Hide the Save Changes button after it is clicked
            document.getElementById("saveButton").style.display = "none";
        });

        // Handle the "Edit Profile" button click (if you want to toggle edit mode)
        document.getElementById("editButton").addEventListener("click", function() {
            const profileForm = document.getElementById('profileForm');
            if (profileForm) {
                profileForm.querySelectorAll('input').forEach(input => {
                    input.disabled = !input.disabled;
                });
                document.getElementById("saveButton").style.display = profileForm.querySelector('input').disabled ? "none" : "inline-block";
            }
        });
    </script>
</body>
</html>
